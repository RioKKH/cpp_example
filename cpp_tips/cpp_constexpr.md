# C++

## constexpr

### 解説

`constexpr` はC++11で導入されたキーワードで、コンパイル時に評価される定数式を定義するために使用されます。`constexpr` を使用する主な目的は、プログラムの実行時ではなくコンパイル時に値を決定し、実行時のパフォーマンスを向上させることです。

`constexpr` と `const` や `#define` マクロとの違いは次のとおりです：

- `const`: `const` キーワードは、変数が宣言後に変更できないことを示します。しかし、`const` 変数の値は実行時に設定され、コンパイル時にはその値が決まっている必要はありません。
- `#define` マクロ: プリプロセッサマクロはコンパイル前にテキスト置換を行います。これにより、コードの読みやすさが低下したり、デバッグが困難になることがあります。また、型安全ではないため、意図しない振る舞いを引き起こす可能性があります。

`constexpr` の利点は、コンパイル時の評価によるパフォーマンス向上、型安全性、デバッグのしやすさです。

### 具体例

```c++
constexpr int factorial(int n) {
    return n <= 1 ? 1 : (n * factorial(n - 1));
}

int main() {
    constexpr int val = factorial(5);  // コンパイル時に計算される
    int array[val];  // 配列のサイズとして使用可能
}
```

この例では、`factorial` 関数はコンパイル時に評価されます。これにより、`val` はコンパイル時に決定され、実行時に計算を行う必要がなくなります。また、`constexpr` により、コンパイル時にサイズが決定される配列を作成することが可能になります。これは `const` や `#define` では実現できない機能です。