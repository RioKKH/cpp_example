# moduleコマンドの基本

`module`コマンドは [Environment Modules](https://modules.sourceforge.net/) のCLIツールで、スパコンで利用可能なアプリケーションの多くはこのシステムを通じて提供されます。これを用いることで、ユーザーが必要としている正確なソフトウェア環境を設定することが出来ます。

### 1. モジュールのロード

特定のソフトウェアやライブラリを使用可能にするためには、該当するモジュールをロードする必要があります。以下はPython 3.8をロードする場合に実行するコマンドになります。

```bash
$ module load python/3.8
```

上記コマンドを実行することで、Python 3.8に関連する環境変数 (PATH, LD_LIBRARY_PATHなど) を設定し、そのバージョンのPythonが利用可能となります。

### 2. モジュールのアンロード（続き）

使用が終わったモジュールをアンロードするには、次のようにコマンドを実行します。

```bash
$ module unload python/3.8
```

このコマンドは、Python 3.8 に関連した環境変数を元に戻し（ロード時に設定された変更を解除し）、他のバージョンの Python など別の環境を使用する準備を整えます。

### 3. モジュールのリスト表示

現在ロードされているモジュールの一覧を表示するには、次のコマンドを使用します。

```bash
$ module list
```

このコマンドは、セッションにロードされているすべてのモジュールとそのバージョンを表示します。これにより、現在の作業環境がどのように設定されているかを把握することができます。

### 4. モジュールの入れ替え

あるバージョンのモジュールをアンロードして、別のバージョンをロードする場合、`module swap` コマンドを使用します。例えば、Python 3.8 から Python 3.7 に切り替える場合は、次のように実行します。

```bash
$ module swap python/3.8 python/3.7
```

このコマンドは、最初に `python/3.8` をアンロードし、次に `python/3.7` をロードします。これは、バージョン変更が頻繁に必要な作業に特に便利です。

KAGAYAKI上で実行してみた結果は以下の通りです。
```bash
s2030025@spcc-a40g06:~$ module avail cuda 
-------------------------- /app/.modules/GPU/cuda --------------------------
cuda/10.0  cuda/10.2  cuda/11.6u2  cuda/11.8  cuda/12.1  
s2030025@spcc-a40g06:~$ module swap cuda/11.8 cuda/12.1 # 11.8と12.1を入れ替えてみた
s2030025@spcc-a40g06:~$ module list 
Currently Loaded Modulefiles:
 1) cuda/12.1 # 12.1になっている事が確認できた
s2030025@spcc-a40g06:~$ module swap cuda/12.1 cuda/11.8 # 11.8に戻す
s2030025@spcc-a40g06:~$ module list
Currently Loaded Modulefiles:
 1) cuda/11.8  # 11.8に戻っている事が確認できた
```

### 5. モジュールの検索

利用可能なモジュールを検索するには、`module avail` コマンドを使用します。これにより、システムにインストールされているすべてのモジュールとそのバージョンが表示されます。特定のソフトウェア名で検索を絞り込むこともできます。

```bash
$ module avail python
```

このコマンドは、利用可能なすべての Python モジュールとそのバージョンを表示します。

これらのコマンドは、スパコンユーザーが自分の作業環境を効率的かつ正確に管理するために非常に重要です。適切なソフトウェアとバージョンの管理を行うことで、予期しないエラーや競合を避け、研究や開発の効率を高めることができます。